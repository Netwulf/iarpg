# Story 1.5: Frontend Foundation (Next.js App Router + UI)

## Status
Draft

## Story
**As a** Developer,
**I want** to set up the Next.js frontend with TailwindCSS, shadcn/ui components, and basic page structure,
**so that** the frontend is ready for feature implementation with a consistent design system.

## Acceptance Criteria
1. TailwindCSS is configured with design tokens from Front-End Spec (colors, fonts, spacing)
2. shadcn/ui is installed and configured in `packages/ui` workspace
3. Basic components (Button, Input, Card, Dialog) are added to packages/ui
4. Global styles (globals.css) match Front-End Spec design system
5. Landing page, Login page, and Dashboard page routes are scaffolded
6. Next.js App Router is configured correctly (app directory structure)
7. Layout component with navigation is created
8. Frontend can connect to backend API (http://localhost:3001)

## Tasks / Subtasks

- [ ] Configure TailwindCSS with design tokens (AC: 1, 4)
  - [ ] Install TailwindCSS in packages/ui: `pnpm add tailwindcss autoprefixer postcss`
  - [ ] Create `packages/ui/tailwind.config.js` with design tokens from Front-End Spec
  - [ ] Add colors: black (#0A0A0A), green-neon (#39FF14), gray scale
  - [ ] Add font families: Inter (sans), JetBrains Mono (mono)
  - [ ] Add font sizes with line-heights (display, h1-h4, body, small)
  - [ ] Add spacing scale (1-20 in 4px increments)
  - [ ] Add animation keyframes (spin-dice, pulse-green, fade-in)

- [ ] Create global styles (AC: 4)
  - [ ] Create `apps/web/src/styles/globals.css`
  - [ ] Import TailwindCSS base, components, utilities
  - [ ] Define CSS variables matching design tokens
  - [ ] Set body defaults (bg-black, text-white, font-sans)
  - [ ] Add scrollbar styling (dark theme)
  - [ ] Import globals.css in root layout

- [ ] Initialize shadcn/ui in packages/ui (AC: 2)
  - [ ] Run `pnpm dlx shadcn-ui@latest init` in packages/ui
  - [ ] Configure to use TailwindCSS from packages/ui
  - [ ] Set base color to zinc (matches gray scale)
  - [ ] Enable CSS variables mode
  - [ ] Create `packages/ui/src/components/` directory

- [ ] Add core UI components (AC: 3)
  - [ ] Add Button: `pnpm dlx shadcn-ui@latest add button`
  - [ ] Add Input: `pnpm dlx shadcn-ui@latest add input`
  - [ ] Add Card: `pnpm dlx shadcn-ui@latest add card`
  - [ ] Add Dialog: `pnpm dlx shadcn-ui@latest add dialog`
  - [ ] Add Label: `pnpm dlx shadcn-ui@latest add label`
  - [ ] Export all components from `packages/ui/src/index.ts`

- [ ] Configure Next.js to use packages/ui (AC: 2)
  - [ ] Add `transpilePackages: ['@iarpg/ui']` to next.config.js
  - [ ] Create `apps/web/tailwind.config.js` extending packages/ui config
  - [ ] Add `@iarpg/ui` dependency to apps/web/package.json
  - [ ] Test importing Button from '@iarpg/ui/components/button'

- [ ] Create App Router structure (AC: 5, 6)
  - [ ] Create `apps/web/src/app/layout.tsx` (root layout)
  - [ ] Create `apps/web/src/app/page.tsx` (landing page)
  - [ ] Create `apps/web/src/app/login/page.tsx` (login page)
  - [ ] Create `apps/web/src/app/register/page.tsx` (register page)
  - [ ] Create `apps/web/src/app/dashboard/page.tsx` (dashboard page)
  - [ ] Create `apps/web/src/app/dashboard/layout.tsx` (dashboard layout with nav)

- [ ] Create Layout component with navigation (AC: 7)
  - [ ] Create `apps/web/src/components/layout/nav.tsx`
  - [ ] Add navigation links (Dashboard, Tables, Characters)
  - [ ] Add user menu dropdown (Profile, Settings, Logout)
  - [ ] Add logo with link to home
  - [ ] Style navigation with TailwindCSS (black bg, green-neon accents)

- [ ] Set up API client for backend communication (AC: 8)
  - [ ] Install axios: `pnpm add axios` in apps/web
  - [ ] Create `apps/web/src/lib/api-client.ts`
  - [ ] Configure base URL (http://localhost:3001)
  - [ ] Add request interceptor to attach auth token
  - [ ] Add response interceptor for error handling
  - [ ] Export typed API client

- [ ] Create placeholder pages (AC: 5)
  - [ ] Landing page: Hero section + CTA
  - [ ] Login page: Login form (uses Story 1.3 auth)
  - [ ] Register page: Registration form
  - [ ] Dashboard page: "Welcome" message + quick actions

- [ ] Test frontend setup (AC: 1-8)
  - [ ] Run `pnpm dev` in apps/web
  - [ ] Verify app loads at http://localhost:3000
  - [ ] Test navigation between pages
  - [ ] Verify TailwindCSS classes work (green-neon color)
  - [ ] Verify shadcn/ui components render correctly
  - [ ] Test API client can connect to backend health endpoint

## Dev Notes

### TailwindCSS Configuration
**[Source: Front-End Spec Section 6.1.1 - Design Tokens]**

**`packages/ui/tailwind.config.js` (COPY-PASTE READY):**
```javascript
/** @type {import('tailwindcss').Config} */
module.exports = {
  darkMode: ['class'],
  content: [
    './src/**/*.{ts,tsx}',
    '../../apps/web/src/**/*.{ts,tsx}',
  ],
  theme: {
    extend: {
      colors: {
        // Base
        black: '#0A0A0A',
        white: '#FFFFFF',

        // Gray Scale
        gray: {
          900: '#1A1A1A',
          800: '#2A2A2A',
          700: '#3A3A3A',
          600: '#6A6A6A',
          500: '#8A8A8A',
          400: '#9A9A9A',
          300: '#AAAAAA',
          200: '#CACACA',
          100: '#EAEAEA',
        },

        // Brand Green (Neon accent)
        green: {
          neon: '#39FF14',
          dim: '#2DD10F',
          dark: '#1FA806',
        },

        // Functional Colors
        blue: '#3B82F6',
        red: '#EF4444',
        yellow: '#F59E0B',
      },

      fontFamily: {
        sans: ['Inter', 'system-ui', 'sans-serif'],
        mono: ['JetBrains Mono', 'monospace'],
      },

      fontSize: {
        // Display
        display: ['48px', { lineHeight: '56px', letterSpacing: '-0.02em' }],

        // Headings
        h1: ['32px', { lineHeight: '40px', letterSpacing: '-0.01em' }],
        h2: ['24px', { lineHeight: '32px', letterSpacing: '-0.01em' }],
        h3: ['20px', { lineHeight: '28px', letterSpacing: '0' }],
        h4: ['18px', { lineHeight: '26px', letterSpacing: '0' }],

        // Body
        body: ['15px', { lineHeight: '24px', letterSpacing: '0' }],
        small: ['13px', { lineHeight: '20px', letterSpacing: '0' }],
        xs: ['11px', { lineHeight: '16px', letterSpacing: '0.01em' }],
      },

      spacing: {
        1: '4px',
        2: '8px',
        3: '12px',
        4: '16px',
        5: '20px',
        6: '24px',
        8: '32px',
        10: '40px',
        12: '48px',
        16: '64px',
        20: '80px',
      },

      borderRadius: {
        sm: '4px',
        DEFAULT: '8px',
        md: '8px',
        lg: '12px',
        xl: '16px',
        '2xl': '24px',
      },

      animation: {
        'spin-dice': 'spin-dice 0.2s ease-out',
        'pulse-green': 'pulse-green 0.3s ease-out 2',
        'fade-in': 'fade-in 0.2s ease-out',
      },

      keyframes: {
        'spin-dice': {
          '0%': { transform: 'rotate(0deg)' },
          '100%': { transform: 'rotate(360deg)' },
        },
        'pulse-green': {
          '0%, 100%': { opacity: '1' },
          '50%': { opacity: '0.5' },
        },
        'fade-in': {
          '0%': { opacity: '0' },
          '100%': { opacity: '1' },
        },
      },
    },
  },
  plugins: [require('tailwindcss-animate')],
};
```

### Global Styles
**[Source: Front-End Spec Section 6.1.1]**

**`apps/web/src/styles/globals.css` (COPY-PASTE READY):**
```css
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Colors */
    --color-black: #0A0A0A;
    --color-green-neon: #39FF14;
    --color-green-dim: #2DD10F;
    --color-green-dark: #1FA806;

    /* Spacing */
    --space-1: 4px;
    --space-2: 8px;
    --space-3: 12px;
    --space-4: 16px;
    --space-5: 20px;
    --space-6: 24px;
    --space-8: 32px;
    --space-10: 40px;
    --space-12: 48px;
    --space-16: 64px;
    --space-20: 80px;

    /* Typography */
    --font-sans: 'Inter', system-ui, sans-serif;
    --font-mono: 'JetBrains Mono', monospace;
  }

  * {
    @apply border-gray-700;
  }

  body {
    @apply bg-black text-white font-sans antialiased;
  }

  /* Custom Scrollbar */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    @apply bg-gray-900;
  }

  ::-webkit-scrollbar-thumb {
    @apply bg-gray-600 rounded-md hover:bg-gray-500;
  }
}

@layer components {
  /* Max Width for readable content */
  .prose {
    max-width: 680px;
    line-height: 1.6;
  }
}
```

### Root Layout
**[Source: Next.js App Router conventions]**

**`apps/web/src/app/layout.tsx`:**
```typescript
import { Inter, JetBrains_Mono } from 'next/font/google';
import './globals.css';

const inter = Inter({ subsets: ['latin'], variable: '--font-sans' });
const jetbrainsMono = JetBrains_Mono({ subsets: ['latin'], variable: '--font-mono' });

export const metadata = {
  title: 'IA-RPG - Text-Based RPG Platform',
  description: 'Play D&D 5e in sync, async, or solo modes with AI assistance',
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en" className={`${inter.variable} ${jetbrainsMono.variable}`}>
      <body>{children}</body>
    </html>
  );
}
```

### Landing Page
**[Source: Front-End Spec Section 5 - Wireframes]**

**`apps/web/src/app/page.tsx`:**
```typescript
import Link from 'next/link';
import { Button } from '@iarpg/ui/components/button';

export default function LandingPage() {
  return (
    <div className="flex min-h-screen flex-col items-center justify-center p-8">
      <h1 className="text-display font-bold mb-6">
        IA-RPG
      </h1>
      <p className="text-h3 text-gray-400 mb-8 max-w-2xl text-center">
        Play text-based D&D 5e on your schedule. Sync, async, or solo with AI.
      </p>
      <div className="flex gap-4">
        <Button asChild size="lg">
          <Link href="/register">Get Started</Link>
        </Button>
        <Button asChild variant="outline" size="lg">
          <Link href="/login">Login</Link>
        </Button>
      </div>
    </div>
  );
}
```

### Dashboard Layout with Navigation
**[Source: Front-End Spec Section 5.2 - Dashboard Wireframe]**

**`apps/web/src/components/layout/nav.tsx`:**
```typescript
import Link from 'next/link';
import { Button } from '@iarpg/ui/components/button';

export function Nav() {
  return (
    <nav className="border-b border-gray-800 bg-black">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="flex justify-between h-16 items-center">
          {/* Logo */}
          <Link href="/dashboard" className="text-h3 font-bold">
            IA-RPG
          </Link>

          {/* Navigation Links */}
          <div className="flex gap-6">
            <Link
              href="/dashboard"
              className="text-body text-gray-400 hover:text-green-neon transition-colors"
            >
              Dashboard
            </Link>
            <Link
              href="/tables"
              className="text-body text-gray-400 hover:text-green-neon transition-colors"
            >
              Tables
            </Link>
            <Link
              href="/characters"
              className="text-body text-gray-400 hover:text-green-neon transition-colors"
            >
              Characters
            </Link>
          </div>

          {/* User Menu */}
          <div className="flex gap-4 items-center">
            <Link
              href="/profile"
              className="text-body text-gray-400 hover:text-green-neon"
            >
              Profile
            </Link>
            <Button variant="outline" size="sm">
              Logout
            </Button>
          </div>
        </div>
      </div>
    </nav>
  );
}
```

**`apps/web/src/app/dashboard/layout.tsx`:**
```typescript
import { Nav } from '@/components/layout/nav';

export default function DashboardLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <div className="min-h-screen flex flex-col">
      <Nav />
      <main className="flex-1 max-w-7xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-8">
        {children}
      </main>
    </div>
  );
}
```

### API Client Configuration
**[Source: Architecture Section 10.4 - Frontend API Client]**

**`apps/web/src/lib/api-client.ts`:**
```typescript
import axios from 'axios';

const apiClient = axios.create({
  baseURL: process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001',
  headers: {
    'Content-Type': 'application/json',
  },
  withCredentials: true,
});

// Request interceptor - attach auth token
apiClient.interceptors.request.use((config) => {
  // In Story 1.3, we'll get token from NextAuth session
  // For now, just pass through
  return config;
});

// Response interceptor - handle errors
apiClient.interceptors.response.use(
  (response) => response,
  (error) => {
    if (error.response?.status === 401) {
      // Redirect to login (handled in Story 1.3)
      console.error('Unauthorized - redirecting to login');
    }
    return Promise.reject(error);
  }
);

export { apiClient };
```

### shadcn/ui Installation
**[Source: shadcn/ui docs + Architecture Section 3]**

**Steps to initialize shadcn/ui:**
```bash
cd packages/ui
pnpm dlx shadcn-ui@latest init
```

**Configuration when prompted:**
- **Style:** Default
- **Base color:** Zinc
- **CSS variables:** Yes
- **Where is your global CSS file:** N/A (using in apps/web)
- **Configure components.json:** Yes
- **Path aliases:** @/components

**Add components:**
```bash
cd packages/ui
pnpm dlx shadcn-ui@latest add button input card dialog label
```

**Export components from `packages/ui/src/index.ts`:**
```typescript
export { Button } from './components/button';
export { Input } from './components/input';
export { Card, CardHeader, CardTitle, CardContent } from './components/card';
export { Dialog, DialogTrigger, DialogContent, DialogHeader, DialogTitle } from './components/dialog';
export { Label } from './components/label';
```

### Next.js Configuration
**[Source: Architecture Section 10.1 - Frontend Architecture]**

**`apps/web/next.config.js`:**
```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  reactStrictMode: true,
  typescript: {
    ignoreBuildErrors: false,
  },
  eslint: {
    ignoreDuringBuilds: false,
  },
  experimental: {
    typedRoutes: true,
  },
  transpilePackages: ['@iarpg/ui', '@iarpg/shared'],
};

module.exports = nextConfig;
```

**`apps/web/tailwind.config.js` (extends packages/ui):**
```javascript
const baseConfig = require('../../packages/ui/tailwind.config');

/** @type {import('tailwindcss').Config} */
module.exports = {
  ...baseConfig,
  content: [
    './src/**/*.{ts,tsx}',
    '../../packages/ui/src/**/*.{ts,tsx}',
  ],
};
```

### Environment Variables
**[Source: Architecture Section 14.2]**

**`apps/web/.env.local`:**
```bash
# Backend API
NEXT_PUBLIC_API_URL=http://localhost:3001

# NextAuth (from Story 1.3)
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET="your-secret"

# Supabase (from Story 1.2)
NEXT_PUBLIC_SUPABASE_URL="https://xxxxx.supabase.co"
NEXT_PUBLIC_SUPABASE_ANON_KEY="eyJhbGc..."
```

### Testing

**Test Framework:** Vitest + Testing Library + Playwright

**Testing Standards:**
**[Source: Architecture Section 16 - Testing Strategy]**

**Component tests (Vitest + Testing Library):**
```typescript
import { render, screen } from '@testing-library/react';
import { Button } from '@iarpg/ui/components/button';

describe('Button', () => {
  it('renders children', () => {
    render(<Button>Click me</Button>);
    expect(screen.getByText('Click me')).toBeInTheDocument();
  });
});
```

**E2E tests (Playwright):**
```typescript
import { test, expect } from '@playwright/test';

test('landing page loads', async ({ page }) => {
  await page.goto('http://localhost:3000');
  await expect(page.locator('text=IA-RPG')).toBeVisible();
});

test('navigation works', async ({ page }) => {
  await page.goto('http://localhost:3000/dashboard');
  await page.click('text=Tables');
  await expect(page).toHaveURL('/tables');
});
```

**For this story:**
- Test components render without errors
- Test navigation between pages works
- Test TailwindCSS classes apply correctly
- Test API client can make requests to backend

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-30 | 1.0 | Initial story draft | Bob (SM) |

## Dev Agent Record

### Agent Model Used
_To be filled by dev agent_

### Debug Log References
_To be filled by dev agent_

### Completion Notes List
_To be filled by dev agent_

### File List
_To be filled by dev agent_

## QA Results
_To be filled by QA agent_
